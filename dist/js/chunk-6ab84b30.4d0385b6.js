(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ab84b30"],{"690d":function(e,t,a){},"77be":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"account-wrap d-flex flex-column"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 col-md-7"},[a("h3",{staticClass:"title py-3 border bg-white text-center mb-4"},[e._v(" 修改個人資料 ")]),e._m(0),a("div",{staticClass:"tab-content rounded-card card"},[a("div",{staticClass:"tab-pane fade show active",attrs:{id:"edit-name","aria-labelledby":"edit-name-tab"}},[a("div",{staticClass:"card-body p-4 d-flex flex-column align-items-center"},[a("img",{staticClass:"headshot rounded-circle d-block mb-3",staticStyle:{"object-fit":"cover",border:"2px #000 solid"},attrs:{src:null==e.previewUrl?e.getPictureUrl("noAvatar.jpeg"):e.previewUrl}}),a("input",{ref:"uploadImage",staticClass:"d-none",attrs:{type:"file",accept:"image/png, image/jpeg"},on:{change:function(t){return e.previewPicture()}}}),a("button",{staticClass:"btn bg-black text-white rounded-0 shadow-none px-4 py-2",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.$refs.uploadImage.click()}}},[e._v(" 上傳大頭照 ")]),a("form",{staticClass:"mt-3"},[a("div",{staticClass:"mb-3"},[a("label",{staticClass:"form-label",attrs:{for:"name"}},[e._v("暱稱")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.name,expression:"userInfo.name"}],staticClass:"form-control rounded-0",attrs:{type:"text",id:"name",placeholder:"請輸入暱稱"},domProps:{value:e.userInfo.name},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"name",t.target.value)}}})]),a("div",{staticClass:"mb-3"},[a("label",{staticClass:"form-label",attrs:{for:"sex"}},[e._v("性別")]),a("div",[a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.sex,expression:"userInfo.sex"}],staticClass:"form-check-input",attrs:{type:"radio",id:"female",value:"female"},domProps:{checked:e._q(e.userInfo.sex,"female")},on:{change:function(t){return e.$set(e.userInfo,"sex","female")}}}),a("label",{staticClass:"form-check-label",attrs:{for:"female"}},[e._v("女性")])]),a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.sex,expression:"userInfo.sex"}],staticClass:"form-check-input",attrs:{type:"radio",id:"male",value:"male"},domProps:{checked:e._q(e.userInfo.sex,"male")},on:{change:function(t){return e.$set(e.userInfo,"sex","male")}}}),a("label",{staticClass:"form-check-label",attrs:{for:"male"}},[e._v("男性")])])])]),a("button",{staticClass:"btn btn-secondary w-100 mt-3",attrs:{type:"button"},on:{click:function(t){return e.editProfile()}}},[e._v(" 送出更新 ")])])])]),a("div",{staticClass:"tab-pane fade",attrs:{id:"edit-password","aria-labelledby":"edit-password-tab"}},[a("div",{staticClass:"card-body p-4 d-flex flex-column align-items-center"},[a("form",[a("div",{staticClass:"mb-3"},[a("label",{staticClass:"form-label",attrs:{for:"password"}},[e._v("輸入新密碼")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordInfo.password,expression:"passwordInfo.password"}],staticClass:"form-control rounded-0",attrs:{type:"password",id:"password",placeholder:"請輸入新密碼"},domProps:{value:e.passwordInfo.password},on:{input:function(t){t.target.composing||e.$set(e.passwordInfo,"password",t.target.value)}}})]),a("div",{staticClass:"mb-3"},[a("label",{staticClass:"form-label",attrs:{for:"confirmPassword"}},[e._v("再次輸入")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordInfo.confirmPassword,expression:"passwordInfo.confirmPassword"}],staticClass:"form-control rounded-0",attrs:{type:"password",id:"confirmPassword",placeholder:"再次輸入輸入新密碼"},domProps:{value:e.passwordInfo.confirmPassword},on:{input:function(t){t.target.composing||e.$set(e.passwordInfo,"confirmPassword",t.target.value)}}})]),a("button",{staticClass:"btn btn-secondary w-100 mt-3",attrs:{type:"button",disabled:!e.formIsFinished},on:{click:function(t){return e.updatePassword()}}},[e._v(" 重設密碼 ")])])])])])]),a("div",{staticClass:"col-12 col-md-5 d-none d-md-block"},[a("Sidebar")],1),a("div",{staticClass:"d-md-none"},[a("SidebarSm")],1)]),a("loading",{attrs:{active:e.isLoading},on:{"update:active":function(t){e.isLoading=t}}})],1)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticClass:"ms-2 nav nav-tabs border-0",attrs:{id:"myTab",role:"tablist"}},[a("li",{staticClass:"nav-item"},[a("button",{staticClass:"nav-link border px-4 active",attrs:{id:"edit-name-tab","data-bs-toggle":"tab","data-bs-target":"#edit-name",type:"button","aria-controls":"edit-name","aria-selected":"true"}},[e._v(" 暱稱修改 ")])]),a("li",{staticClass:"nav-item"},[a("button",{staticClass:"nav-link border px-4",attrs:{id:"edit-password-tab","data-bs-toggle":"tab","data-bs-target":"#edit-password",type:"button","aria-controls":"edit-password","aria-selected":"false"}},[e._v(" 重設密碼 ")])])])}],n=a("1da1"),o=a("5530"),i=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("d9e2"),a("d401"),a("b0c0"),a("2f62")),c={name:"Following",components:{Sidebar:function(){return a.e("chunk-1e767b91").then(a.bind(null,"5ea5"))},SidebarSm:function(){return a.e("chunk-70b44a3f").then(a.bind(null,"7441"))}},data:function(){return{isLoading:!1,userInfo:{name:"",sex:"",photo:""},passwordInfo:{password:"",confirmPassword:""},errorMessage:[],uploadImg:null,previewUrl:null}},computed:{formIsFinished:function(){return this.passwordInfo.password&&this.passwordInfo.confirmPassword}},created:function(){this.getProfile()},methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])({setUserInfo:"setUserInfo"})),{},{getProfile:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,s,r,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,e.$api.getUserProfile();case 4:if(a=t.sent,a.data&&"success"===a.status){t.next=7;break}throw new Error("取得資料失敗");case 7:s=a.data,r=s.name,n=s.sex,o=s.photo,e.userInfo={name:r,sex:n,photo:o},""!==o&&(e.previewUrl=o),e.isLoading=!1,t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](0),e.$toasted.show(t.t0.message),e.isLoading=!1;case 17:case"end":return t.stop()}}),t,null,[[0,13]])})))()},editProfile:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,e.uploadImage();case 4:return t.next=6,e.$api.editUserProfile(e.userInfo);case 6:if(a=t.sent,a&&"success"===a.status){t.next=9;break}throw a.message;case 9:e.setUserInfo(e.userInfo),e.isLoading=!1,e.getProfile(),t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](0),e.isLoading=!1,e.$toasted.show(t.t0.message);case 18:case"end":return t.stop()}}),t,null,[[0,14]])})))()},uploadImage:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){if(e.isLoading=!0,!e.uploadImg)return t();var s=e.$store.state.token;e.isLoading=!0;var r=new FormData;r.append("image",e.uploadImg),r.append("type","avatar"),e.axios({method:"post",url:"".concat("https://metawall-snow.herokuapp.com","/uploadImage"),data:r,headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(s)}}).then((function(a){"success"===a.data.status&&(e.userInfo.photo=a.data.data.imgUrl,e.isLoading=!1,t(a.data.data.imgUrl))}))["catch"]((function(t){e.isLoading=!1,a(t.response)}))})));case 1:case"end":return t.stop()}}),t)})))()},previewPicture:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==e.$refs.uploadImage.files.length){t.next=2;break}return t.abrupt("return");case 2:if(e.uploadImg=e.$refs.uploadImage.files[0],e._imageFormatCheck(e.uploadImg),!(e.errorMessage.length>0)){t.next=6;break}return t.abrupt("return");case 6:return a=function(){return new Promise((function(t){var a=new FileReader;a.readAsDataURL(e.uploadImg),a.onload=function(e){t(e.target.result)}}))},t.next=9,a();case 9:e.previewUrl=t.sent;case 10:case"end":return t.stop()}}),t)})))()},_imageFormatCheck:function(e){e.size/1024/1024>1&&this.errorMessage.push("圖片檔案過大，僅限 1mb 以下檔案")},updatePassword:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,e.$api.updatePassword(e.passwordInfo);case 4:if(a=t.sent,a&&"success"===a.status){t.next=7;break}throw a.message;case 7:e.passwordInfo={},e.isLoading=!1,t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),e.isLoading=!1,e.$toasted.show("更新失敗，"+t.t0.message);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))()}})},d=c,l=(a("b94f"),a("2877")),u=Object(l["a"])(d,s,r,!1,null,"73ad6aa0",null);t["default"]=u.exports},b0c0:function(e,t,a){var s=a("83ab"),r=a("5e77").EXISTS,n=a("e330"),o=a("9bf2").f,i=Function.prototype,c=n(i.toString),d=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,l=n(d.exec),u="name";s&&!r&&o(i,u,{configurable:!0,get:function(){try{return l(d,c(this))[1]}catch(e){return""}}})},b94f:function(e,t,a){"use strict";a("690d")}}]);
//# sourceMappingURL=chunk-6ab84b30.4d0385b6.js.map